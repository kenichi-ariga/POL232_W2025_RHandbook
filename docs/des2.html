<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Descriptive Statistics (2) – POL232 R Handbook (W2025)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./bivariate.html" rel="next">
<link href="./des1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./des2.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Descriptive Statistics (2)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">POL232 R Handbook (W2025)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Setting Up R &amp; RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Use of RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./des1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Descriptive Statistics (1)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./des2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Descriptive Statistics (2)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bivariate Analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preparation" id="toc-preparation" class="nav-link active" data-scroll-target="#preparation"><span class="header-section-number">4.1</span> Preparation</a>
  <ul class="collapse">
  <li><a href="#before-you-start" id="toc-before-you-start" class="nav-link" data-scroll-target="#before-you-start"><span class="header-section-number">4.1.1</span> Before You Start</a></li>
  <li><a href="#actually-write-r-functions" id="toc-actually-write-r-functions" class="nav-link" data-scroll-target="#actually-write-r-functions"><span class="header-section-number">4.1.2</span> Actually Write R Functions</a></li>
  </ul></li>
  <li><a href="#sec-bar-chart-edit-vars" id="toc-sec-bar-chart-edit-vars" class="nav-link" data-scroll-target="#sec-bar-chart-edit-vars"><span class="header-section-number">4.2</span> Bar Chart: ggplot() + geom_bar() &amp; Edit Variables</a>
  <ul class="collapse">
  <li><a href="#change-angle-of-value-labels-on-x-axis-theme-axis.text.x-element_text" id="toc-change-angle-of-value-labels-on-x-axis-theme-axis.text.x-element_text" class="nav-link" data-scroll-target="#change-angle-of-value-labels-on-x-axis-theme-axis.text.x-element_text"><span class="header-section-number">4.2.1</span> Change Angle of Value Labels on X Axis: <code>theme()</code>, <code>axis.text.x</code>, <code>element_text()</code></a></li>
  <li><a href="#na-missing-observations" id="toc-na-missing-observations" class="nav-link" data-scroll-target="#na-missing-observations"><span class="header-section-number">4.2.2</span> <code>NA</code>: Missing Observations</a></li>
  <li><a href="#factor-for-categorical-variables-glimpse" id="toc-factor-for-categorical-variables-glimpse" class="nav-link" data-scroll-target="#factor-for-categorical-variables-glimpse"><span class="header-section-number">4.2.3</span> <code>Factor</code> for Categorical Variables: <code>glimpse()</code></a></li>
  <li><a href="#create-new-variable-mutate-head" id="toc-create-new-variable-mutate-head" class="nav-link" data-scroll-target="#create-new-variable-mutate-head"><span class="header-section-number">4.2.4</span> Create New Variable: <code>mutate()</code>, <code>head()</code></a></li>
  <li><a href="#sec-change-factor-levels-order" id="toc-sec-change-factor-levels-order" class="nav-link" data-scroll-target="#sec-change-factor-levels-order"><span class="header-section-number">4.2.5</span> Change Levels and Their Order of Factor: <code>levels()</code>, <code>fct_relevel()</code></a></li>
  <li><a href="#sec-change-factor-levels-names" id="toc-sec-change-factor-levels-names" class="nav-link" data-scroll-target="#sec-change-factor-levels-names"><span class="header-section-number">4.2.6</span> Change Names of Categories/Levels: <code>fct_recode()</code></a></li>
  <li><a href="#sec-remove-na" id="toc-sec-remove-na" class="nav-link" data-scroll-target="#sec-remove-na"><span class="header-section-number">4.2.7</span> Remove NA: <code>drop_na()</code></a></li>
  </ul></li>
  <li><a href="#computing-summary-statistics" id="toc-computing-summary-statistics" class="nav-link" data-scroll-target="#computing-summary-statistics"><span class="header-section-number">4.3</span> Computing Summary Statistics</a>
  <ul class="collapse">
  <li><a href="#standard-deviation-and-iqr-sd-iqr" id="toc-standard-deviation-and-iqr-sd-iqr" class="nav-link" data-scroll-target="#standard-deviation-and-iqr-sd-iqr"><span class="header-section-number">4.3.1</span> Standard Deviation and IQR: <code>sd()</code>, <code>IQR()</code></a></li>
  <li><a href="#mode-for-categorical-variables" id="toc-mode-for-categorical-variables" class="nav-link" data-scroll-target="#mode-for-categorical-variables"><span class="header-section-number">4.3.2</span> Mode for Categorical Variables</a></li>
  <li><a href="#median-for-ordinal-catagorical-variables-change-factor-to-numeric-as.numeric" id="toc-median-for-ordinal-catagorical-variables-change-factor-to-numeric-as.numeric" class="nav-link" data-scroll-target="#median-for-ordinal-catagorical-variables-change-factor-to-numeric-as.numeric"><span class="header-section-number">4.3.3</span> Median for Ordinal Catagorical Variables — Change <code>Factor</code> to <code>Numeric</code>: <code>as.numeric()</code></a></li>
  </ul></li>
  <li><a href="#box-plot-geom_boxplot" id="toc-box-plot-geom_boxplot" class="nav-link" data-scroll-target="#box-plot-geom_boxplot"><span class="header-section-number">4.4</span> Box Plot: geom_boxplot()</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-des2" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Descriptive Statistics (2)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="preparation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="preparation"><span class="header-section-number">4.1</span> Preparation</h2>
<section id="before-you-start" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="before-you-start"><span class="header-section-number">4.1.1</span> Before You Start</h3>
<p><strong>Before you start</strong> working on this chapter, you need to do the following. If you need a help for each step, see <a href="des1.html#sec-preparation" class="quarto-xref"><span>Section 3.1</span></a>.</p>
<ul>
<li><p>Launch <strong>RStudio</strong>.</p></li>
<li><p>Load <code>POL232.RData</code> into your current <strong>R</strong> session.</p></li>
<li><p>Prepare an <strong>R Script</strong> to save all your work in this chapter. I suggest you name it “<code>POL232_Lab#_YourLastName.R</code>” in which <code>#</code> is the number of the current lab session.</p></li>
<li><p>You also need to load <code>tidyverse</code> package into your current <strong>R</strong> session (<a href="setup.html#sec-load-packages" class="quarto-xref"><span>Section 1.4.2</span></a>).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="actually-write-r-functions" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="actually-write-r-functions"><span class="header-section-number">4.1.2</span> Actually Write R Functions</h3>
<p>I repeat below the suggestions I made in <a href="des1.html#sec-actually-write-rscript" class="quarto-xref"><span>Section 3.1.5</span></a>.</p>
<ul>
<li><p>I suggest you <span class="red-text">actually write</span> <strong>the R functions</strong> used below in your <strong>R script</strong> instead of copying and pasting them. By <span class="red-text">actually writing them</span> and <span class="red-text">occasionally making mistakes and correcting them</span>, you can get used to how <strong>RStudio</strong> works more quickly and effectively.</p></li>
<li><p>If you <span class="red-text">simply copy and paste</span> them, you will <span class="red-text">not learn much</span> about <strong>RStudio</strong> and will <span class="red-text">not get used to it</span>.</p></li>
<li><p>In your <strong>R script</strong>, leave <span class="red-text">sufficient descriptions</span> of the functions after <strong>the <code>#</code> sign</strong> (see <a href="basic.html#sec-r-comments" class="quarto-xref"><span>Section 2.2.2</span></a>) so that you can use your <strong>R script</strong> later <span class="red-text">as your reference</span> when you conduct analysis using these <strong>R functions</strong>.</p></li>
<li><p>These descriptions are <span class="red-text">notes for yourself</span>. Organize these descriptions/notes so that they are <span class="red-text">convenient for your futur use</span>.</p></li>
</ul>
</section>
</section>
<section id="sec-bar-chart-edit-vars" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-bar-chart-edit-vars"><span class="header-section-number">4.2</span> Bar Chart: ggplot() + geom_bar() &amp; Edit Variables</h2>
<p>In <a href="des1.html" class="quarto-xref"><span>Chapter 3</span></a>, we learned how to draw <strong>a histogram</strong> using <strong>the <code>ggplot()</code> function</strong>.</p>
<p><strong>A histogram</strong> is an appropriate visualization if the variable of interest takes <span class="red-text">many values</span> and/or is <span class="red-text">continuous</span>. If the variable takes only <span class="red-text">a small number of values</span> and/or is <span class="red-text">categorical</span>, <strong>a bar chart</strong> may be more appropriate. Let’s draw <strong>a bar chart</strong> for the variable on the respondent’s <strong>perception of economy</strong> (<code>percep_economy_cps</code>) from <strong>the Canadian Election Study 2019</strong> (<code>ces2019</code>).</p>
<p>To draw <strong>a bar chart</strong>, we augment <strong>the <code>ggplot()</code> function</strong> with <strong>the <code>geom_bar()</code> function</strong> (as opposed to <strong>the <code>geom_histogram()</code> function</strong> we used to draw <strong>a histogram</strong>).</p>
<p>First, try the simplest implementation of these functions as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ces2019, <span class="fu">aes</span>(percep_economy_cps)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p>We can apply many of <span class="red-text">the additional arguments and functions</span> we learned for <strong>a histogram</strong> to <strong>a bar chart</strong>. Let’s see an example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  bar_econ <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ces2019, <span class="fu">aes</span>(percep_economy_cps)) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"dodgerblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Perception of Economy"</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(bar_econ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p>Note that in the above code, I assigned <strong>the <code>ggplot()</code> functions</strong> for <strong>a bar chart</strong> to <strong>a new object <code>bar_econ</code></strong> and then used <strong>the <code>print()</code> function</strong> to draw it.</p>
<p>Try to identify what each line of the above code accomplishes. If you need a refresher, see <a href="des1.html" class="quarto-xref"><span>Chapter 3</span></a>. You can also use <span class="red-text">a keyword search</span> over the entire webbook from the left menu.</p>
<p>By the way, as we saw in <a href="des1.html#sec-assign-hist-new-object" class="quarto-xref"><span>Section 3.4</span></a>, instead of using <strong>the <code>print()</code>function</strong>, you can also simply type in <code>bar_econ</code> in <strong>the R Console</strong> to run <strong>the <code>ggplot()</code> functions</strong> assigned to <code>bar_econ</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  bar_econ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<section id="change-angle-of-value-labels-on-x-axis-theme-axis.text.x-element_text" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="change-angle-of-value-labels-on-x-axis-theme-axis.text.x-element_text"><span class="header-section-number">4.2.1</span> Change Angle of Value Labels on X Axis: <code>theme()</code>, <code>axis.text.x</code>, <code>element_text()</code></h3>
<p>In <strong>the X-axis</strong> of the above <strong>bar chart</strong>, notice that <span class="red-text">the names of the categories (or values)</span> of <strong>the variable</strong> cannot be read because of an overlap. This is because the names are too long to be properly displayed in a horizontal direction.</p>
<p>We can change <span class="red-text">the angle of the names of the categories (or values)</span> of <strong>a variable</strong> (= <strong>value labels of a variable</strong>) by <strong>the <code>theme</code> function</strong> as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  bar_econ <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p>If you specify <span class="red-text">a different number</span> to <code>angle</code>, then value labels are presented in <span class="red-text">a different angle</span>. For example, try the following.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>  bar_econ <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p>We may want to <span class="red-text">edit</span> this <strong>bar chart</strong> further. First, instead of “Better,” “Worse,” and “About the Same” in the above <strong>bar chart</strong>, we may want to <span class="red-text">re-order them</span> from “Worse,” “About the Same” to “Better.” Second, we may want to <span class="red-text">change the name of the categories</span> — more specifically, we may want to remove the numbers and parentheses and shorten the name from “About the same” to “same.” Third, we may want to <span class="red-text">remove “NA”</span> from <strong>the bar chart</strong>.</p>
<p>We will do <span class="red-text">these edits</span> one by one.</p>
</section>
<section id="na-missing-observations" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="na-missing-observations"><span class="header-section-number">4.2.2</span> <code>NA</code>: Missing Observations</h3>
<p>By the way, <code>NA</code> indicates <strong>the observations</strong> for which <strong>the variable</strong> of interest is <span class="red-text">missing</span>. We call such <strong>observations</strong> <span class="red-text">“missing observations”</span> and <strong>those <code>NA</code>s</strong> <span class="red-text">“missing values.”</span></p>
<p>To know more about <span class="red-text">missing observations</span>, browse <code>ces2019</code> using <strong>the <code>View()</code> function</strong> or clicking <code>ces2019</code> in the <strong>Environment</strong> tab on the upper right pane.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">View</span>(ces2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, you can find that for <strong>some observations</strong>, <span class="red-text">the values</span> of <strong>some variables</strong> are <code>NA</code>, as shown below. These entries (<code>NA</code>s) indicate that <span class="red-text">the values</span> of <strong>these variables</strong> are <span class="red-text">missing</span> for <strong>these observations</strong>.</p>
<p><img src="figures/RHB_Ch4_Fig1.png" class="img-fluid" style="width:75.0%"></p>
<p><strong>The <code>ggplot() + geom_bar()</code> functions</strong> include these <span class="red-text">missing observations</span> in <strong>the bar chart</strong> they draw. However, we may want to exclude these <span class="red-text">missing observations</span> from <strong>the bar chart</strong>.</p>
</section>
<section id="factor-for-categorical-variables-glimpse" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="factor-for-categorical-variables-glimpse"><span class="header-section-number">4.2.3</span> <code>Factor</code> for Categorical Variables: <code>glimpse()</code></h3>
<p>Depending on their characteristics, <strong>variables</strong> in <strong>a data frame</strong> may be stored in different formats in <code>R</code>. Normally, our dataset includes both <span class="red-text">quantitative (or numeric) variables</span>, which take numbers (numerical values), and <span class="red-text">categorical variables</span>, which take a set of categories. Of the variables from <code>ces2019</code> that we have examined so far, the Trudeau thermometer (<code>truedeau_therm_cps</code>) is <span class="red-text">a quantitative (or numeric) variable</span>, as it takes a number between <code>0</code> and <code>100</code>. Respondent’s perception of the state of the national economy (<code>percep_economy_cps</code>) is <span class="red-text">a categorical variable</span>, as it takes three categories indicating the respondents’ perception of economy. These two types of variables are stored in different formats in a data frame.</p>
<p>To see different formats for variables, try <strong>the <code>glimpse()</code> function</strong> below with <span class="red-text">the name of a data frame</span> as <strong>its argument</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>(ces2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,021
Columns: 5
$ sample_id         &lt;dbl&gt; 18, 32, 39, 59, 61, 69, 157, 158, 165, 167, 185, 220…
$ birth_year        &lt;dbl&gt; 1963, 1973, 1994, 2000, 1984, 1939, 1999, 1995, 1963…
$ gender            &lt;fct&gt; (1) Male, (1) Male, (1) Male, (1) Male, (1) Male, (1…
$ province          &lt;fct&gt; QC, QC, QC, QC, QC, QC, QC, QC, QC, QC, QC, QC, QC, …
$ satisfied_dem_cps &lt;fct&gt; (3) Not very satisfied, (2) Fairly satisfied, (1) Ve…</code></pre>
</div>
</div>
<p>Your <strong>R Console</strong> prints a list like the one above for all variables in <code>ces2019</code>. For brevity, I printed only the first five variables above. As its name suggests, <strong>the <code>glimpse()</code> function</strong> offers <span class="red-text">a glimpse into your data frame</span> — names of variables, their format, and the values of the first few observations.</p>
<p>In this list, you can see that the format<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> of the variables are either <code>&lt;dbl&gt;</code> or <code>&lt;fct&gt;</code>.</p>
<p><code>&lt;dbl&gt;</code> is for <span class="red-text">numeric (or quantitative) variables</span>,<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> for which each value is number, and <code>&lt;fct&gt;</code> is for <span class="red-text">categorical variables</span>, which is stored in a format called <code>factor</code>. For example, <code>sample_id</code> and <code>birth_year</code> are <span class="red-text">numbers (numeric variables)</span>, hence they are given <code>&lt;dbl&gt;</code> in the list above. <code>gender</code>, <code>province</code>, and <code>satisfied_dem_cps</code> are <span class="red-text">categorical variables</span>, and the list above indicates <code>&lt;fct&gt;</code> for these variables. A <code>factor</code> is a special format for <span class="red-text">categorical variables</span> in <strong>R</strong>, which offers convenient functionalities for this type of variable. We will use these functionalities of <code>factor</code> to edit <code>percep_eonomy_cps</code>.</p>
</section>
<section id="create-new-variable-mutate-head" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="create-new-variable-mutate-head"><span class="header-section-number">4.2.4</span> Create New Variable: <code>mutate()</code>, <code>head()</code></h3>
<p>Suppose we want to <span class="red-text">create</span> <strong>a new variable</strong> for which <span class="red-text">the order of categories</span> of <code>percep_economy_cps</code> will appear from “Worse,” “Same” to “Better” when we draw <strong>a bar chart</strong>.</p>
<p>We will create such a variable step by step in the next few sections.</p>
<p>In this section, I will explain how we can <span class="red-text">create</span> <strong>a new variable</strong> in <strong>our data frame</strong>. For simplicity, we will create a new variable <code>percep_economy_cps_copy</code> which is exactly the same as <code>percep_economy_cps</code>. We can do this by <strong>the <code>mutate()</code> function</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  ces2019 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(ces2019, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">percep_economy_cps_copy =</span> percep_economy_cps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>The first argument</strong> of <strong>the <code>mutate()</code> function</strong> is <span class="red-text">the data frame to which we want to add a new variable</span>. Its <strong>second argument</strong> specifies <span class="red-text">the content of this new variable</span> by <code>name-of-new-variable = its-content</code>. In the above code, it is specified that the new variable <code>percep_economy_cps_copy</code> equals <code>percep_economy_cps</code>.</p>
<p>The right hand side of <code>&lt;-</code> (the assignment operator<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, see <a href="basic.html#sec-assignment-operator" class="quarto-xref"><span>Section 2.3.3</span></a>) in the above code mutated the data frame <code>ces2019</code> by adding a new variable <code>percep_economy_cps_copy</code>. Then, this new, mutated data frame is assigned to <code>ces2019</code> on the left hand side of <code>&lt;-</code>. In other words, <code>ces2019</code> is now updated with an additional variable <code>percep_economy_cps_copy</code>.</p>
<p>Check if the new variable <code>percep_economy_cps_copy</code> is added to your data frame using <strong>the <code>glimpse()</code> function</strong>. If you apply <strong>the <code>glimpse()</code> function</strong> to <code>ces2019</code>, now you can see this new variable <code>percep_economy_cps_copy</code> <span class="red-text">at the end of the data frame</span>. For brevity, I show only <code>percep_economy_cps</code> and <code>percep_economy_cps_copy</code> below. They are exactly the same.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>(ces2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,021
Columns: 2
$ percep_economy_cps      &lt;fct&gt; (2) Worse, (3) About the same, (1) Better, (3)…
$ percep_economy_cps_copy &lt;fct&gt; (2) Worse, (3) About the same, (1) Better, (3)…</code></pre>
</div>
</div>
<p>We can also use <strong>the <code>head()</code> function</strong> to see <span class="red-text">the first few observations</span> of a variable. Try the code below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ces2019<span class="sc">$</span>percep_economy_cps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] (2) Worse          (3) About the same (1) Better         (3) About the same
[5] (1) Better         (2) Worse         
Levels: (1) Better (2) Worse (3) About the same</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ces2019<span class="sc">$</span>percep_economy_cps_copy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] (2) Worse          (3) About the same (1) Better         (3) About the same
[5] (1) Better         (2) Worse         
Levels: (1) Better (2) Worse (3) About the same</code></pre>
</div>
</div>
<p>As you can see, the values for each observation are exactly the same between <code>percep_economy_cps</code> and <code>percep_economy_cps_copy</code>.</p>
<p>By specifying <strong>the right hand side of <code>=</code> in the second argument</strong> of <strong>the <code>mutate()</code> function</strong> <span class="red-text">in different ways</span>, we can <span class="red-text">create different types of new variables</span>.</p>
<p><strong>The <code>mutate()</code> function</strong> may also be used to <span class="red-text">edit the existing variables in our data frame</span>.</p>
<p>We will see a few examples in this chapter and subsequent chapters.</p>
</section>
<section id="sec-change-factor-levels-order" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="sec-change-factor-levels-order"><span class="header-section-number">4.2.5</span> Change Levels and Their Order of Factor: <code>levels()</code>, <code>fct_relevel()</code></h3>
<p>Let’s explore <span class="red-text">the characteristics of</span> <code>factor</code> a little further.</p>
<p>When <span class="red-text">categorical variables</span> are stored as <code>factor</code> in <strong>R</strong>, they are associated with <code>levels</code>, which represent <span class="red-text">the name of each category</span>, such as “(1) Better” and “(2) Worse”, and assigns <span class="red-text">a specific order</span> to these categories.</p>
<p>You can find <code>levels</code> of categorical variables stored as <code>factor</code> by <strong>the <code>levels()</code> function</strong> with <span class="red-text">the name of the variable</span> as <strong>its argument</strong>.</p>
<p>Recall that as <code>percep_economy_cps</code> is one column of the data frame <code>ces2019</code>, we use <code>$</code> to access it — more specifically, we refer to <code>percep_economy_cps</code> as <code>ces2019</code><span class="red-text">$</span><code>percep_economy_cps</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>(ces2019<span class="sc">$</span>percep_economy_cps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(1) Better"         "(2) Worse"          "(3) About the same"</code></pre>
</div>
</div>
<p>The output lists the three categories, or <code>levels</code>, taken by <code>percep_economy_cps</code>. Also, these <code>levels</code> are associated with <span class="red-text">the order that appears above</span>. So, if we draw <strong>a bar chart</strong> of this variable, <strong>bars</strong> are <span class="red-text">ordered by this order associated with</span> <code>levels</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ces2019, <span class="fu">aes</span>(percep_economy_cps)) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"dodgerblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Perception of Economy"</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p><strong>Bars</strong> appeared from “(1) Better”, “(2) Worse”, to “(3) About the same”. To <span class="red-text">change the order of</span> <strong>bars</strong>, we need to <span class="red-text">change the order of</span> <code>levels</code> for <code>percep_econ_cps</code>. We can do this by <strong>the <code>fct_relevel()</code> function</strong>.</p>
<p><span class="red-text">A basic syntax</span> of <strong>the <code>fct_relevel()</code> function</strong> is the following. <span class="red-text">Don’t execute the code below</span> because it is not intended to be implemented; it is used only to show the syntax of <strong>this R function</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fct_relevel</span>( factor_variable, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"First Level"</span>, <span class="st">"Second Level"</span>, <span class="st">"Third Level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first argument of <strong>the <code>fct_relevel()</code> function</strong> is <span class="red-text">the categorical variable</span> stored as <code>factor</code> that we want to <span class="red-text"><strong>“relevel”</strong></span> (i.e., <span class="red-text">change the order of categories</span>).</p>
<p>Then, it is followed by the <code>levels</code> or categories of this variable <span class="red-text">in the order we want</span>.</p>
<p>Below, I use <strong>the <code>mutate()</code> function</strong> to create a new variable <code>percep_economy_cps2</code> in which <code>percep_economy_cps</code> is <span class="red-text">releveled</span> or <span class="red-text">reordered</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>  ces2019 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(ces2019, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">percep_economy_cps2 =</span> <span class="fu">fct_relevel</span>(percep_economy_cps, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"(2) Worse"</span>, <span class="st">"(3) About the same"</span>, <span class="st">"(1) Better"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we saw in the previous section, <strong>the <code>mutate()</code> function</strong> on the right hand side of <code>&lt;-</code> creates a new variable <code>percep_economy_cps2</code> in the data frame <code>ces2019</code>. In its second argument, <strong>the <code>fct_relevel()</code> function</strong> is used to specify the content of the new variable. By <strong>this <code>fct_relevel()</code> function</strong>, <code>percep_economy_cps2</code> equals <code>percep_economy_cps</code> but with different ordering of its levels or categories. The order of the levels or categories of <code>percep_economy_cps2</code> is now from “(2) Worse” to “(3) About the same” to “(1) Better”.</p>
<p>By the above code, <code>ces2019</code> is now updated with <span class="red-text">an additional variable</span> <code>percep_economy_cps2</code>, with <span class="red-text">the desired order of its levels or categories</span>. Let’s check that the new variable <code>percep_economy_cps2</code> is releveled or reordered as we wanted using the <code>levels()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>(ces2019<span class="sc">$</span>percep_economy_cps2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(2) Worse"          "(3) About the same" "(1) Better"        </code></pre>
</div>
</div>
<p>The variable is indeed releveled or reordered as we specified.</p>
<p>Let’s draw <strong>a bar chart</strong> for <span class="red-text">this releveled variable</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ces2019, <span class="fu">aes</span>(percep_economy_cps2)) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"dodgerblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Perception of Economy"</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p>Now <strong>the bars</strong> appeared <span class="red-text">in the order we wanted</span>.</p>
</section>
<section id="sec-change-factor-levels-names" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="sec-change-factor-levels-names"><span class="header-section-number">4.2.6</span> Change Names of Categories/Levels: <code>fct_recode()</code></h3>
<p>Next we will <span class="red-text">remove numbers</span>, such as <code>(1)</code> and <code>(2)</code>, <span class="red-text">from each category of</span> <code>percep_economy_cps2</code> and <span class="red-text">change</span> “About the Same” to “Same.” Specifically, we will <span class="red-text">create a new variable</span> named <code>percep_economy_cps3</code> with our desired names of levels or categories of <code>percep_economy_cps2</code>. For this purpose, we use <strong>the <code>fct_recode()</code> function</strong>. <span class="red-text">A basic syntax</span> of <strong>the <code>fct_recode()</code> function</strong> is as follows. Once again, don’t implement the code below, as it is not intended to be implemented; it is used only to show a syntax of <strong>this R function</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_recode</span>(factor_variable, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"New Name of Level 1"</span> <span class="ot">=</span> <span class="st">"Original Name of Level 1"</span>, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"New Name of Level 2"</span> <span class="ot">=</span> <span class="st">"Original Name of Level 2"</span>, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"New Name of Level 3"</span> <span class="ot">=</span> <span class="st">"Original Name of Level 3"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s create <span class="red-text">a new variable</span> <code>percep_economy_cps3</code> using this function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>  ces2019 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(ces2019, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">percep_economy_cps3 =</span> <span class="fu">fct_recode</span>(percep_economy_cps2, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Worse"</span> <span class="ot">=</span> <span class="st">"(2) Worse"</span>, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Same"</span> <span class="ot">=</span> <span class="st">"(3) About the same"</span>, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Better"</span> <span class="ot">=</span> <span class="st">"(1) Better"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code adds <span class="red-text">a new variable</span> <code>percep_eocnomy_cps3</code> to <code>ces2019</code>. The first argument of <strong>the <code>fct_recode()</code> function</strong> above is <span class="red-text">the name of the variable</span> <span class="red-text">whose levels or categories are changed</span> (<code>precep_economy_cps2</code>). The following arguments specify <span class="red-text">the new name of each level</span> and <span class="red-text">the old name of each level</span>.</p>
<p>Let’s check the levels of <code>percep_economy_cps3</code> by the <code>levels()</code> function to see whether the names of levels or categories were changed as specified.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>(ces2019<span class="sc">$</span>percep_economy_cps3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Worse"  "Same"   "Better"</code></pre>
</div>
</div>
<p>The names of levels or categories were indeed changed as we wanted.</p>
<p>Let’s draw <strong>a histogram</strong> using <span class="red-text">this new variable</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ces2019, <span class="fu">aes</span>(percep_economy_cps3)) <span class="sc">+</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"dodgerblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Perception of Economy"</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p><strong>The bar chart</strong> looks much better now. Note that we didn’t need to use <code>theme(axis.text.x = element_text(angle = 90))</code> anymore in the above code, because the names of categories are short enough to appear horizontally.</p>
</section>
<section id="sec-remove-na" class="level3" data-number="4.2.7">
<h3 data-number="4.2.7" class="anchored" data-anchor-id="sec-remove-na"><span class="header-section-number">4.2.7</span> Remove NA: <code>drop_na()</code></h3>
<p>Now we will <span class="red-text">remove</span> <code>NA</code> from <strong>the bar chart</strong>. For this purpose, we use <strong>the <code>drop_na()</code> function</strong>. <span class="red-text">A basic syntax</span> of <strong>the <code>drop_na()</code> function</strong> is this (the code below is not intended to be implemented).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(name_of_data_frame, name_of_variable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first argument is <span class="red-text">the name of the data frame from which we want to remove missing observations</span>, and the second argument is <span class="red-text">the name of the variable for which we want to eliminate missing observations</span>.</p>
<p>In other words, <strong>the <code>drop_na()</code> function</strong> looks for the observations for which the variable in the second argument is missing (<code>NA</code>) and removes these observations from the data frame in the first argument.</p>
<p>Therefore, if we specify <strong>the <code>drop_na()</code> function</strong> as below, then <strong>the <code>drop_na()</code> function</strong> looks for the observations in <code>ces2019</code> for which <code>percep_economy_cps3</code> is missing (<code>NA</code>), and removes these observations from <code>ces2019</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(ces2019, percep_economy_cps3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To draw <strong>a bar chart</strong> of <code>percep_economy_cps3</code>, we may replace <code>ces2019</code> in the first argument of <strong>the <code>ggplot()</code> function</strong> with <code>drop_na(ces2019, percep_economy_cps3)</code>. In this way, <strong>the <code>ggplot()</code> function</strong> will use a version of <code>ces2019</code> from which the observations with <code>percep_economy_cps3</code> missing are removed. Let’s try this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">drop_na</span>(ces2019, percep_economy_cps3), <span class="fu">aes</span>(percep_economy_cps3)) <span class="sc">+</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"dodgerblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Perception of Economy"</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p>Now we were able to draw <strong>a bar chart</strong> <span class="red-text">without</span> <code>NA</code>.</p>
</section>
</section>
<section id="computing-summary-statistics" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="computing-summary-statistics"><span class="header-section-number">4.3</span> Computing Summary Statistics</h2>
<section id="standard-deviation-and-iqr-sd-iqr" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="standard-deviation-and-iqr-sd-iqr"><span class="header-section-number">4.3.1</span> Standard Deviation and IQR: <code>sd()</code>, <code>IQR()</code></h3>
<p>In <a href="des1.html" class="quarto-xref"><span>Chapter 3</span></a>, we computed <span class="red-text">the mean</span> and <span class="red-text">the median</span> of a variable using <strong>the <code>mean()</code> and <code>median()</code> functions</strong>. Here I introduce <strong>the <code>sd()</code> and <code>IQR()</code> functions</strong> to compute <span class="red-text">the standard deviation</span> and <span class="red-text">IQR</span> of a variable.</p>
<p><span class="red-text">A basic syntax</span> of <strong>the <code>sd()</code> and <code>IQR()</code> functions</strong> is <span class="red-text">the same as</span> <strong>the <code>mean()</code> and <code>median()</code> functions</strong>. The first argument of these functions is the variable for which we want to compute this summary statistic. We should also specify <code>na.rm = TRUE</code> (<code>na.rm</code> stands for “remove NA”). Otherwise, these functions do not compute the summary statistics if there are missing observations for the specified variable.</p>
<p>Below I compute <span class="red-text">the standard deviation</span> and <span class="red-text">IQR</span> for the Trudeau thermometer variable (<code>trudeau_therm_cps</code>) in <code>ces2019</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>(ces2019<span class="sc">$</span>trudeau_therm_cps, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30.68348</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">IQR</span>(ces2019<span class="sc">$</span>trudeau_therm_cps, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60</code></pre>
</div>
</div>
<p><span class="red-text">The standard deviation</span> of the Trudeau thermometer (<code>trudeau_therm_cps</code>) is approximately 31, and its <span class="red-text">IQR</span> is 60.</p>
</section>
<section id="mode-for-categorical-variables" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="mode-for-categorical-variables"><span class="header-section-number">4.3.2</span> Mode for Categorical Variables</h3>
<p>Note that <strong>the <code>mean()</code>, <code>median()</code>, <code>sd()</code>, and <code>IQR()</code> functions</strong> work for <span class="red-text">quantitative or numeric variables</span>, such as <code>trudeau_therm_cps</code>, but do not work for <span class="red-text">categorical variables</span> or <code>factors</code>, such as <code>percep_economy_cps</code>. Let’s try <strong>the <code>mean()</code> function</strong> for <code>percep_economy_cps</code>.</p>
<p>We will get <code>NA</code> and <span class="red-text">an error message</span> saying that we cannot compute this summary statistic for <span class="red-text">categorical variables</span> or <code>factors</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(ces2019<span class="sc">$</span>percep_economy_cps, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in mean.default(ces2019$percep_economy_cps, na.rm = TRUE): argument is
not numeric or logical: returning NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>In fact, while these summary statistics are useful and appropriate for <span class="red-text">quantitative or numeric variables</span>, they may not be useful or appropriate for <span class="red-text">categorical variables</span>.</p>
<p>Especially for <strong>nominal, categorical variables</strong>, neither <span class="red-text">the mean</span> nor <span class="red-text">the median</span> makes sense. For example, consider the variable on individual’s vote intention, in which the possible choices are Liberals, Conservative, NDP, BQ, Greens, and others. It is impossible to conceptualize the average of this variable. As there is no natural order among these choices, we cannot conceptualize the <span class="red-text">median</span> for this variable, either. Instead, an appropriate summary statistic for the center of distribution for <strong>nominal, categorical variables</strong> like this one is <span class="red-text">the mode</span>.</p>
<p><span class="red-text">The mode</span> is also an appropriate summary of the center of distribution for <strong>ordinal categorical variables</strong>. In addition, <span class="red-text">the median</span> is useful for <strong>ordinal variables</strong>, because there is a natural order among the categories of this type of variables.</p>
<p><span class="red-text">The mode</span> of <span class="red-text">a categorical variable</span> may easily be identified from <strong>a bar chart</strong>. Consider <strong>the bar chart</strong> of <code>percep_economy_cps</code> that we drew above.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="336"></p>
</figure>
</div>
</div>
</div>
<p>As <span class="red-text">the mode</span> is <span class="red-text">the category with the largest number of observations</span>, we can easily identify “Same” as <span class="red-text">the mode</span> for this variable.</p>
</section>
<section id="median-for-ordinal-catagorical-variables-change-factor-to-numeric-as.numeric" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="median-for-ordinal-catagorical-variables-change-factor-to-numeric-as.numeric"><span class="header-section-number">4.3.3</span> Median for Ordinal Catagorical Variables — Change <code>Factor</code> to <code>Numeric</code>: <code>as.numeric()</code></h3>
<p><code>percep_economy_cps</code> is <strong>an ordinal, categorical variable</strong> because there is a natural order among each category from “Worse” to “Same” to “Better.” Therefore, we may also want to find <span class="red-text">the median</span> for this variable. As we have seen, however, <strong>the <code>median()</code> function</strong> does not work for <span class="red-text">a categorical variable</span> stored as a <code>factor</code>. Therefore, to apply <strong>the <code>median()</code> function</strong> to <strong>an ordinal, categorical variable</strong>, we first need to transform the categorical variable stored as a <code>factor</code> to a <code>numeric</code> variable. We use <strong>the <code>as.numeric()</code> function</strong> for this purpose. We specify <span class="red-text">the name of the variable which we want to transform</span> to a <code>numeric</code> variable as <strong>the argument</strong> for <strong>the <code>as.numeric()</code> function</strong>.</p>
<p>Let’s create a <code>numeric</code> version of <code>percep_economy_cps</code> using <strong>the <code>mutate()</code> and the <code>as.numeric()</code> functions</strong>. In the code below, I call the new variable <code>percep_ceonomy_cps_n</code>, in which <code>n</code> stands for a <code>numeric</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>  ces2019 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(ces2019, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">percep_economy_cps_n =</span> <span class="fu">as.numeric</span>(percep_economy_cps3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s compare <code>percep_economy_cps3</code> and <code>percep_economy_cps_n</code>. Below I show the first few observations of each variable, respectively, by <strong>the <code>glimpse()</code> function</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>(ces2019)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,021
Columns: 2
$ percep_economy_cps3  &lt;fct&gt; Worse, Same, Better, Same, Better, Worse, NA, Bet…
$ percep_economy_cps_n &lt;dbl&gt; 1, 2, 3, 2, 3, 1, NA, 3, 2, 2, 1, 2, 2, 2, 1, 3, …</code></pre>
</div>
</div>
<p>You may also use <strong>the <code>head()</code> function</strong> to check the first few observations of <code>percep_economy_cps3</code> and <code>percep_economy_cps_n</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ces2019<span class="sc">$</span>percep_economy_cps3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Worse  Same   Better Same   Better Worse 
Levels: Worse Same Better</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ces2019<span class="sc">$</span>percep_economy_cps_n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 2 3 1</code></pre>
</div>
</div>
<p>As you can see above, now <span class="red-text">each category</span> is replaced by <span class="red-text">numbers</span> from 1 to 3 in <code>percep_economy_cps_n</code>. More specifically, <code>percep_economy_cps_n</code> equals 1 for “Worse”, 2 for “Same”, and 3 for “Better.”</p>
<p><span class="red-text">These numbers</span> correspond to <span class="red-text">the order of categories</span> or <code>levels</code> in <code>percep_economy_cps3</code>. Let’s check the order of <code>levels</code> in <code>percep_economy_cps</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levels</span>(ces2019<span class="sc">$</span>percep_economy_cps3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Worse"  "Same"   "Better"</code></pre>
</div>
</div>
<p>As demonstrated in this example, if we apply <strong>the <code>as.numeric()</code> function</strong> to <span class="red-text">a categorical variable</span> stored as a <code>factor</code> to transform it to a <code>numeric</code> variable, <span class="red-text">the numbers that appear in the resulting variable</span> is in <span class="red-text">the order of the</span> <code>levels</code> <span class="red-text">of the original categorical variable</span> stored as a <code>factor</code>.</p>
<p>Since <code>percep_economy_cps_n</code> is a <code>numeric</code> variable, we can apply the functions for summary statistics for <code>numeric</code> variables. For example, we can use <strong>the <code>median()</code> function</strong> to find <span class="red-text">the median category</span> for <code>percep_economy_cps_n</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(ces2019<span class="sc">$</span>percep_economy_cps_n, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p><span class="red-text">The median</span> we got above is 2. Since <code>percep_economy_cps_n</code> = 2 if <code>percep_economy_cps3</code> = “Same,” <span class="red-text">the median</span> of the perception of economy is “Same.”</p>
</section>
</section>
<section id="box-plot-geom_boxplot" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="box-plot-geom_boxplot"><span class="header-section-number">4.4</span> Box Plot: geom_boxplot()</h2>
<p>In this section, we are going to use the <code>ipe2015</code> dataset. We will draw <strong>a box plot</strong> of <code>trade_WDI</code>, which is a volume of trade (export + import) as % of GDP across countries around the world.</p>
<p>To draw <strong>a box plot</strong>, we add <strong>the <code>geom_boxplot()</code> function</strong> to <strong>the <code>ggplot()</code> function</strong>. Below is the simplest implementation without any arguments for <strong>the <code>geom_boxplot()</code> function</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ipe2015, <span class="fu">aes</span>(trade_WDI)) <span class="sc">+</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="504"></p>
</figure>
</div>
</div>
</div>
<p>As we can see, <span class="red-text">the default option</span> of <strong>the <code>geom_boxplot()</code> function</strong> produces <span class="red-text">a horizontal box plot</span>. Let’s change it to <span class="red-text">a vertical box plot</span>. For this purpose, we should specify <code>y = trade_WDI</code> in <strong>the <code>aes()</code> function</strong> inside <strong>the <code>ggplot()</code> function</strong>. This instructs <strong>the <code>ggplot()</code> function</strong> that the values of <code>trade_WDI</code> should appear in the vertical or <code>y</code> axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ipe2015, <span class="fu">aes</span>(<span class="at">y =</span> trade_WDI)) <span class="sc">+</span>              <span class="co"># Add "y =". </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="192"></p>
</figure>
</div>
</div>
</div>
<p><strong>The box</strong> in this <strong>boxplot</strong> may be <span class="red-text">too wide</span>. It would look better if we can make it <span class="red-text">thinner</span>. Below I added <strong>two new arguments</strong>: <code>x = factor(0)</code> in <strong>the <code>aes()</code> function</strong> and <code>width = 0.2</code> in <strong>the <code>geom_boxplot()</code> function</strong>. <strong>The <code>width</code> argument</strong> in <strong>the <code>geom_boxplot()</code> function</strong> controls <span class="red-text">the width of the box</span>. To let this argument work, you also need to specify <code>x = factor(0)</code> in <strong>the <code>aes()</code> function</strong>. You may change <span class="red-text">the width of the box</span> further by specifying a different value for <strong>the <code>width</code> argument</strong> for <strong>the <code>geom_boxplot</code> function</strong>. I’d suggest you try a few different values to see how <span class="red-text">the box width</span> changes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ipe2015, <span class="fu">aes</span>(<span class="at">y =</span> trade_WDI, <span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">0</span>))) <span class="sc">+</span>  <span class="co"># Add x = factor(0). </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>)                           <span class="co"># Specify the width argument.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="192"></p>
</figure>
</div>
</div>
</div>
<p>As suggested in the lecture, <span class="red-text">a default length of whisker</span> is <span class="red-text">1.5 times IQR</span>. While this <span class="red-text">length of whisker</span> looks good to this <strong>box plot</strong>, let’s change it to see how it appears differently. For this purpose, we specify <strong>the <code>coef</code> argument</strong> in <strong>the <code>geom_boxplot()</code> function</strong>. We specify <span class="red-text">the number of times of IQR</span> that we want for <span class="red-text">the length of whisker</span> in <strong>the <code>coef</code> argument</strong>. Below, I specify it at <span class="red-text">3</span>. Then, the length of whisker to be drawn is <span class="red-text">3 times IQR</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ipe2015, <span class="fu">aes</span>(<span class="at">y =</span> trade_WDI, <span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">0</span>))) <span class="sc">+</span>  </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">coef =</span> <span class="dv">3</span>)       <span class="co"># Add the coef argument.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="192"></p>
</figure>
</div>
</div>
</div>
<p>As you can see, <span class="red-text">the length of the upper whisker</span> is <span class="red-text">longer</span> than before, and the two outliers that appeared above the upper whisker disappeared because these outliers are now behind the upper whisker. I’d suggest you try a few different values to see how the length of whisker changes.</p>
<p>Perhaps, you noticed that <span class="red-text">the length of the lower whisker</span> didn’t change. Moreover, in the original <strong>box plot</strong> where we didn’t specify <strong>the <code>coef</code> argument</strong> and therefore, we used the default length of 1.5 times IQR, the length of the lower whisker was shorter than the length of the upper whisker, or 1.5 times IQR. This is because <span class="red-text">the lower (or upper) whisker extends only to the minimum (or maximum) value of a variable</span>. In other words, the minimum value of <code>trade_WDI</code> is within 1.5 times IQR, and therefore, the lower whisker was shorter than the upper whisker in the original <strong>box plot</strong>, and its length didn’t change when we changed the length of whisker to 3 by <strong>the <code>coef</code> argument</strong>.</p>
<p>We can further edit <strong>the box plot</strong> using the functions we learned in <a href="des1.html" class="quarto-xref"><span>Chapter 3</span></a>. (I don’t use <strong>the <code>coef</code> argument</strong> here because 1.5 times IQR seems to be reasonable for this variable.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>  trade_box <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ipe2015, <span class="fu">aes</span>(<span class="at">y =</span> trade_WDI, <span class="at">x =</span> <span class="fu">factor</span>(<span class="dv">0</span>))) <span class="sc">+</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">fill=</span><span class="st">"cyan4"</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trade (% of GDP)"</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(trade_box)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="192"></p>
</figure>
</div>
</div>
</div>
<p>Note that in the above code, I assigned <strong>the <code>ggplot() + geom_boxplot()</code> functions</strong> to a new object <code>trade_box</code> and then used <strong>the <code>print()</code> function</strong> to draw <strong>the box plot</strong>.</p>
<p>You may want to <span class="red-text">remove</span> <code>0</code> <span class="red-text">on the horizontal axis</span>. We can do this by specifying <strong>the <code>axis.text.x</code> argument</strong> for <strong>the <code>theme()</code> function</strong> as follows. Recall that <code>trade_box</code> includes all <strong><code>ggplot() + geom_boxplot()</code> functions</strong> assigned above, and we can add additional functions to <code>trade_box</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>  trade_box <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="192"></p>
</figure>
</div>
</div>
</div>
<p>You may further want to <span class="red-text">remove the tick mark on the horizontal axis</span>. We can do this by specifying <strong>the <code>axis.ticks.x</code> argument</strong> for <strong>the <code>theme()</code> function</strong> as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>  trade_box <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="192"></p>
</figure>
</div>
</div>
</div>
<p>Now this <strong>box plot</strong> looks pretty good.</p>
<p><strong>A box plot</strong> may also be drawn <span class="red-text">horizontally</span>. I suggest you identify what is different in the following code for a horizontal box plot from the previous code for a vertical box plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ipe2015, <span class="fu">aes</span>(<span class="at">x =</span> trade_WDI, <span class="at">y =</span> <span class="fu">factor</span>(<span class="dv">0</span>))) <span class="sc">+</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">fill=</span><span class="st">"cyan4"</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trade (% of GDP)"</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="des2_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="504"></p>
</figure>
</div>
</div>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Here I use the term “format” loosely. There are more precise technical terms, such as “type” and “class”, to refer to the characteristics of R objects, but I don’t use them to avoid unnecessary technical details.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><code>&lt;dbl&gt;</code> stands for “double-precision,” which refers to the level of precision of numbers stored in a variable. For our purposes, you just need to understand that <code>&lt;dbl&gt;</code> is for a numeric variable.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Recall that the assignment operator (&lt;-) assigns the right hand side of &lt;- to the left hand side of &lt;-.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./des1.html" class="pagination-link" aria-label="Descriptive Statistics (1)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Descriptive Statistics (1)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./bivariate.html" class="pagination-link" aria-label="Bivariate Analysis">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bivariate Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>